---
workflow:
  rules:
    - if: '$CI_COMMIT_BRANCH == "master"'

include:
  - project: 'ci-cd/templates'
    ref: master
    file: 'build.docker.gitlab-ci.yml'
  - project: 'ci-cd/templates'
    ref: master
    file: 'deploy.helm.gitlab-ci.yml'

wiki:
  trigger:
    include:
      - project: 'ci-cd/templates'
        file: 'deploy.wiki.gitlab-ci.yml'
  allow_failure: true
  rules:
    - if: '$CI_COMMIT_BRANCH == "master" && $WIKI_ENABLED'

chart_release:
  extends: .chart_release
  rules:
    - if: '$CI_COMMIT_BRANCH == "master" || $CI_COMMIT_BRANCH == "develop"'

deploy_helm:
  extends: .deploy_helm

stop_helm:
  extends: .stop_helm
