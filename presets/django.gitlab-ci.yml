---
variables:

  DJANGO_COMMAND:
    value: ""
    description: |
      –ò–º—è –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞:
      <ul>
          <li>
              <strong>migrate</strong> - –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏
          </li>
          <li>
              <strong>clear_cache</strong> - —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∫—ç—à
          </li>
          <li>
              <strong>init_repositories</strong> - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–Ω–¥–µ–∫—Å—ã Elastic
          </li>
      </ul>

  DJANGO_COMMAND_EXTRA_ARGS:
    value: ""
    description: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥—ã.üåà"

django_command:
  stage: analyse
  allow_failure: true
  when: manual
  script:
    - !reference [.compose-env, script]
    - docker-compose exec -T $MIGRATE_TARGET sh -c "LOGGING_LEVEL=ERROR python manage.py $DJANGO_COMMAND $DJANGO_COMMAND_EXTRA_ARGS"
